CREATE SCHEMA `presto`;

USE presto;

CREATE USER 'presto'@'localhost'
IDENTIFIED BY 'fenixoftPresto';

GRANT ALL ON presto.* TO 'presto'@'localhost';

CREATE TABLE USUARIOS(
	ID_USUARIO INT NOT NULL UNIQUE AUTO_INCREMENT,
    NOMBRE_USUARIO VARCHAR(255) NOT NULL UNIQUE,
    CONTRASEÑA VARCHAR(511) NOT NULL,
    NIVEL_DE_ACCESO INT NOT NULL,
    PRIMARY KEY (ID_USUARIO)
);
CREATE TABLE PRODUCTOS(
	ID_PRODUCTO INT UNIQUE NOT NULL AUTO_INCREMENT,
    ID_CATEGORIA INT NOT NULL,
    NOMBRE VARCHAR(255) NOT NULL UNIQUE,
    PRECIO DOUBLE NOT NULL,
    IMAGEN VARCHAR(255),
    primary key (ID_PRODUCTO)    
);
CREATE TABLE CATEGORIA_PRODUCTOS(
	ID_CATEGORIA INT NOT NULL UNIQUE AUTO_INCREMENT,
    NOMBRE VARCHAR(255) NOT NULL,
    IMAGEN VARCHAR(255) NOT NULL,
    PRIMARY KEY (ID_CATEGORIA)
);
CREATE TABLE VENTAS(
	ID_VENTA INT NOT NULL UNIQUE AUTO_INCREMENT,
    ID_USUARIO INT NOT NULL,
    FECHA DATE NOT NULL,
    HORA TIME NOT NULL,
    TOTAL FLOAT NOT NULL,
    PRIMARY KEY (ID_VENTA)
);
CREATE TABLE PRODUCTOS_VENTAS(
	ID INT NOT NULL UNIQUE AUTO_INCREMENT,
    ID_PRODUCTO INT NOT NULL,
    ID_VENTA INT NOT NULL, 
    CANTIDAD INT NOT NULL,
    PRIMARY KEY (ID)
);
CREATE TABLE DEVOLUCIONES(
	ID_DEVOLUCION INT NOT NULL UNIQUE AUTO_INCREMENT,
    FECHA DATE NOT NULL,
    ID_USUARIO INT NOT NULL,
    HORA TIME NOT NULL,
    TOTAL FLOAT NOT NULL,
    PRIMARY KEY(ID_DEVOLUCION)
);
CREATE TABLE PRODUCTOS_DEVOLUCIONES(
	ID INT NOT NULL UNIQUE AUTO_INCREMENT,
    ID_PRODUCTO INT NOT NULL,
    ID_DEVOLUCION INT NOT NULL,
    CANTIDAD INT NOT NULL,
    PRIMARY KEY(ID)
);
CREATE TABLE EGRESOS(
	ID_EGRESO INT NOT NULL UNIQUE AUTO_INCREMENT,
    FECHA DATE NOT NULL,
    MONTO FLOAT NOT NULL,
    CONCEPTO VARCHAR(511) NOT NULL,
    ID_USUARIO INT NOT NULL,
    PRIMARY KEY(ID_EGRESO)
);
CREATE TABLE CORTES_CAJA(
	ID_CORTE INT NOT NULL UNIQUE AUTO_INCREMENT,
    FECHA DATE NOT NULL UNIQUE,
    APERTURA DOUBLE NOT NULL,
    PRIMARY KEY (ID_CORTE)
);
INSERT INTO USUARIOS(NOMBRE_USUARIO, CONTRASEÑA, NIVEL_DE_ACCESO)
VALUES('Admin', '$2a$10$Hm7W.Q8vL/jxd6oJzB.xKe3q1fmU1BjRYseGT3NQJb5GWF10/Dlg.', 0);
